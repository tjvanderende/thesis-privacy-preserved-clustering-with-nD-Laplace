\input{TheorethicalFramework/ND-Laplace/general-math-symbols.tex}
\section{2D-Laplace}
The idea of \gls{gi} was introduced to solve the issue of privacy and location data \citep{DBLP:journals/corr/abs-1212-1984}.
It offers an alternative approach for achieving differential privacy for geographical data (latitude/longitude).
The mechanism achieves this by adding noise to the location locally before sending it to a location-based system (LBS) like Google Maps for example.
This section starts with an introduction to mathematics and for each of the different subsections, we visualize and explain open challenges and theoretic for applying them for clustering.
%\glsaddall
%\leading{10pt}
%\printglossary[type=genericmath, nonumberlist]
%The other symbols can be found in section \ref{section:dp}.
\subsection*{Geo-indistinguishability}
As mentioned in the previous section, the \gls{gi} method can be applied to preserve the privacy using a differential privacy method specific to spatial data.
The formula to measure if an algorithm preserves $\epsilon$-geo-indistinguishability can be expressed as \citep{DBLP:journals/corr/abs-1212-1984}:
\begin{equation}
  K(x)(y) \le e^{\epsilon * d(x,x`)} K(x`)(y)
  \label{algo:2d-geo-indistinguishability}
\end{equation}
Where $K$ is a probability method reporting $x, x` \in X$ as $z \in Z$.
The idea of this algorithm looks a lot like that of differential privacy using the La Place method; but includes distance.
The intuition for this is that it displays the distinguishability level between two secret locations/points $x$ and $x`$ \citep{chatzikokolakis_constructing_2015}.
An extension of this is called $d_x$-privacy and is a more general notation of distance-aware differential privacy.
Their definition for \gls{gi} is, therefore, $d_2$-privacy, but is essentially the same as the proof provided for \gls{gi}.

\subsection{Planar and polar Laplace}
%\printglossary[type=2dlaplace]
The idea of planar Laplace is to generate an area around $x0 \in X$ according to the multivariate Laplace distribution.
The mechanism of planar Laplace is a modification of the Laplace algorithm to support distance \citep{DBLP:journals/corr/abs-1212-1984}.
This distance method $dist(x, x_`)$ is defined as the Euclidean distance between two points or sets.
Recalling the definition of Laplace, this method $|x-x_`|$ is replaced by the distance metric.
Hence, the definition of the Probability Density Function (pdf) by Andr√©s et al. is:
\begin{equation}
  \frac{\epsilon^2}{2*\pi}e(-\epsilon d(x_0, x))
\end{equation}
Which is the likelihood a generated point $z \in Z$ is close to $x0$.
The method works for Cartesian coordinates but was modified to support polar coordinates by including $\theta$.
So each point is reflected as $(r, \theta)$ and can be modified by using a slight modification to work for polar Laplace.
A point $z \in Z$ where $z = (r, \theta)$ is randomly generated using two separate methods for calculating $r$ and $\theta$.
\begin{figure}[h]
  \includegraphics[scale=0.6]{TheorethicalFramework/ND-Laplace/Images/polar-laplace.png}
  \centering
  \caption{Representation of the generated $z = {r \theta}$ and original point $x0$.}
  \label{figure:parea}
\end{figure}

\textbf{Calculating $r$:}
This variable is described as $dist(x_0, z)$ and can be randomly drawn by inverting the CDF for the Laplace distribution:
\begin{equation}
  C{_\epsilon}{^{-1}}(p) = - \frac{1}{\epsilon}(W_-1 (\frac{p - 1}{e}) + 1)
\end{equation}
For this equation, $W_-1$ is a Lambert W function with -1 branch.
The Lambert w function, also called the product logarithm is defined as $W(x)e^{W(x)} = x$ \citep{lehtonen_lambert_2016}.
The purpose of the Lambert w function is to invert the CDF of the Laplace distribution to generate random noise for one of the coordinates ($r$) using the random value of $p$.

\textbf{Calculating $\theta$:}
The other coordinate ($\theta$) is defined as a random number $[0, 2\pi]$. \newline
To visualize these methods it is necessary to convert the polar coordinates for $z = (r, \theta)$ back to a plane $(x, y)$.
This is described as step 4 of the planar Laplace algorithm \citep{DBLP:journals/corr/abs-1212-1984} and visualized using figure \ref{figure:geo}.
\begin{figure}[h]
  \includegraphics[width=0.8\textwidth]{TheorethicalFramework/ND-Laplace/Images/polar-laplace-to-planar.png}
  \centering
  \caption{Representation of converting the perturbed point $z = (r, \theta)$ to a point ${z_x, z_y}$}
  \label{figure:geo}
\end{figure}

\mycomment{
  %% If we want to know if a point is within the radius, 
  We highlight the CDF function \todo{Can be moved to appendix} for assessing if the probability of a random point falls between 0 and $r$:
  \begin{equation}
    C{\epsilon}(r) = D_\epsilon,R(p)dp = \int_{0}^{r} 1 - (1 + \epsilon r ) e^{-\epsilon r}
  \end{equation}
}


\newpage
\subsection{Truncation} \label{theory:truncation}
The truncation is an important part of the mechanism to ensure the data is contained within the domain of the original data $X$.
If this is not the case, the data is easily distinguished by an unwanted adversary \citep{DBLP:journals/corr/abs-1212-1984,9646489}.
We assume that a user has a set of data points with a range of [-1, 1].
If noise is added to it, it cannot be ensured that this data falls outside this range (figure \ref{figure:truncation-2d}).
\begin{figure}[ht]
  \includegraphics[width=0.7\textwidth]{TheorethicalFramework/ND-Laplace/Images/remapping.png}
  \caption{Representation of truncation of data points for 2-dimensional Laplace mechanism.}
  \label{figure:truncation-2d}
\end{figure}

A solution was described by Andres et al. in step 5 of the Laplacian mechanism for 2D space \citep{DBLP:journals/corr/abs-1212-1984}.
The idea is to create a grid around the diameter of the set of points $X = R^2$ that belong to the user.
This grid is defined as $G = \{g_1, g_2, ..., g_n\}$ where $g_i$ is a grid point.
So, if a point is generated outside the given domain, it is remapped to the closest in $X \subset G$.

This was later improved by chatzikokolakis et al, introducing an optimized way of remapping \citep{chatzikokolakis_practical_nodate}.
The algorithm uses the Bayesian rule for minimizing the loss of utility while remapping the data.
Instead of remapping to the closest point, it remaps to a location where the loss is minimal.
To decrease the performance impact of this algorithm, it is possible to only consider a certain region around the perturbed point $z$.
The disadvantage of this method is the need for a prior set of data points to calculate the optimal remapping.
It does not work for new users, and it extends the training period.

\subsection{Optimizing for clustering}
The decision of the parameters for the algorithm is straightforward as it depends on the $\epsilon$. \label{paragraph:choosing-r}
This constant is calculated by defining the radius $r$ and the desired level of privacy $l$ and $\epsilon$ is calculated using $l/r$.
The $l$ is a predefined constant $l \in R^+$ but usually will be below 10.
For geographical data, the $r$ can be configured by using meters as a unit of measure.
So for example $r = 200$ corresponds to a radius of 200m around point $x_0$.
Without a unit, it is a challenge to define a reasonable radius.
%The $\epsilon$ can be considered the inverse unit of $r$ \citep{DBLP:journals/corr/abs-1212-1984}.

In that regard, the radius can also be a flexible value that is defined based on the crowdedness of a region \citep{chatzikokolakis_constructing_2015}.
If a user is located in a crowded area, the radius can be smaller than if the user is located in a rural area (because the user's location is indistinguishable due to the overlap of other users' locations).
Instead of providing \gls{gi}, the authors introduce a more flexible privacy definition $d_x$-privacy.
The $r$ is calculated based on the mass of other locations in the region $r$, which they call \emph{privacy mass}.
So, the total mass of a set A is defined as $M(A) = \sum_{x \in A} m(x) = a + q(x)b$.
Where $m(x)$ is the mass of a location $x$ and is of value [0, 1].
For this formula, $a$ is the number of points assigned to each location.
The authors define $q(x)$ as the "quality" of a point, which is essentially the number of other users that are also interested in the same point (e.g. a mall).

The $a$ is defined as a Euclidean ball $B_r = {x' | d_{euc}(x, x') \leq r}$, which returns all locations within the radius $r$.
To retrieve a value within [0, 1], the authors use the following formula:
\begin{equation}
  a = \frac{1}{|B_r|}
  \label{equation:privacy-mass-a}
\end{equation}
If the locations are only considered for space and not quality, $q(x)$ is defined as 0 \citep{chatzikokolakis_constructing_2015}. \newline
%A radius can be defined per-use case based on how crowded a place is \citep{chatzikokolakis_constructing_2015}.

Although the method is an interesting approach to increasing utility while not reducing privacy it is hard to adopt for the purpose of clustering.
For applying it for \gls{ldp}, it is required to supply each user with prior knowledge of the dataset.
This would require an interactive setup of the mechanism instead of non-interactive \todo{Give link to Laplace}. \newline

A drawn area as shown in \ref{figure:parea} can be expressed as a perturbation area $P_{area}$ \citep{yan_perturb_2022-2}.
This metric was formulated as:
\begin{equation}
  P_{area}=\left\{ center = x_{0},radius = \frac{1}{N}\times \sum _{i=1}^{N}r_{i}\right\}
\end{equation}
The method loops through each perturbed point $r$ on center $x_0$ (recall \ref{figure:parea}) and calculates the Euclidean distance for an $n$ amount of perturbation points.
Although the method does not contribute to the Laplace algorithm, it is useful for visualization purposes.
This method can also be applied for efficiently calculating the grid points for the truncation method (recall \ref{theory:truncation}).
\newpage